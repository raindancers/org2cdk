"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.SmithyBuild = void 0;
const component_1 = require("../component");
const json_1 = require("../json");
/**
 * Smithy build configuration options
 */
class SmithyBuild extends component_1.Component {
    constructor(project, options = {}) {
        super(project);
        this.version = options.version ?? "1.0";
        this.outputDirectory = options.outputDirectory;
        this._imports = options.imports;
        this._projections = options.projections;
        this._plugins = options.plugins;
        this.ignoreMissingPlugins = options.ignoreMissingPlugins;
        this._maven = options.maven;
        this.manifest = {
            version: this.version,
            outputDirectory: this.outputDirectory,
            imports: () => this._imports,
            projections: () => this._projections,
            plugins: () => this._plugins,
            ignoreMissingPlugins: this.ignoreMissingPlugins,
            maven: () => this._maven,
        };
        new json_1.JsonFile(this.project, "smithy-build.json", {
            obj: this.manifest,
            readonly: true,
            newline: false, // when file is edited by npm/yarn it doesn't include a newline
        });
    }
    /**
     * Get configured projections
     */
    get projections() {
        return this._projections ? { ...this._projections } : undefined;
    }
    /**
     * Get configured imports
     */
    get imports() {
        return this._imports ? [...this._imports] : undefined;
    }
    /**
     * Get configured plugins
     */
    get plugins() {
        return this._plugins ? { ...this._plugins } : undefined;
    }
    /**
     * Add a smithy build import
     */
    addImport(imp) {
        this._imports ? this._imports.push(imp) : (this._imports = [`${imp}`]);
    }
    /**
     * Add smithy build projections
     */
    addProjections(projections) {
        for (const [k, v] of Object.entries(projections)) {
            this._projections
                ? (this._projections[k] = v)
                : (this._projections = { [k]: v });
        }
    }
    /**
     * Add smithy build plugins
     */
    addPlugins(plugins) {
        for (const [k, v] of Object.entries(plugins)) {
            this._plugins ? (this._plugins[k] = v) : (this._plugins = { [k]: v });
        }
    }
    /**
     * Add maven dependencies to the smithy build for the vs-code plugin
     */
    addMavenDependencies(...dependencies) {
        this._maven = {
            dependencies: [...(this._maven?.dependencies ?? []), ...dependencies],
            repositories: this._maven?.repositories ?? [],
        };
    }
    /**
     * Add maven repositories to the smithy build for the vs-code plugin
     */
    addMavenRepositories(...repositories) {
        this._maven = {
            dependencies: this._maven?.dependencies ?? [],
            repositories: [...(this._maven?.repositories ?? []), ...repositories],
        };
    }
}
exports.SmithyBuild = SmithyBuild;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic21pdGh5LWJ1aWxkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3NtaXRoeS9zbWl0aHktYnVpbGQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsNENBQXlDO0FBRXpDLGtDQUFtQztBQTZFbkM7O0dBRUc7QUFDSCxNQUFhLFdBQVksU0FBUSxxQkFBUztJQWdEeEMsWUFBWSxPQUFnQixFQUFFLFVBQThCLEVBQUU7UUFDNUQsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBRWYsSUFBSSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUMsT0FBTyxJQUFJLEtBQUssQ0FBQztRQUN4QyxJQUFJLENBQUMsZUFBZSxHQUFHLE9BQU8sQ0FBQyxlQUFlLENBQUM7UUFDL0MsSUFBSSxDQUFDLFFBQVEsR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDO1FBQ2hDLElBQUksQ0FBQyxZQUFZLEdBQUcsT0FBTyxDQUFDLFdBQVcsQ0FBQztRQUN4QyxJQUFJLENBQUMsUUFBUSxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUM7UUFDaEMsSUFBSSxDQUFDLG9CQUFvQixHQUFHLE9BQU8sQ0FBQyxvQkFBb0IsQ0FBQztRQUN6RCxJQUFJLENBQUMsTUFBTSxHQUFHLE9BQU8sQ0FBQyxLQUFLLENBQUM7UUFFNUIsSUFBSSxDQUFDLFFBQVEsR0FBRztZQUNkLE9BQU8sRUFBRSxJQUFJLENBQUMsT0FBTztZQUNyQixlQUFlLEVBQUUsSUFBSSxDQUFDLGVBQWU7WUFDckMsT0FBTyxFQUFFLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxRQUFRO1lBQzVCLFdBQVcsRUFBRSxHQUFHLEVBQUUsQ0FBQyxJQUFJLENBQUMsWUFBWTtZQUNwQyxPQUFPLEVBQUUsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLFFBQVE7WUFDNUIsb0JBQW9CLEVBQUUsSUFBSSxDQUFDLG9CQUFvQjtZQUMvQyxLQUFLLEVBQUUsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLE1BQU07U0FD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Q3RFLENBQUM7SUFDSixDQUFDO0NBQ0Y7QUEvSUQsa0NBK0lDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSBcIi4uL2NvbXBvbmVudFwiO1xuaW1wb3J0IHsgTWF2ZW5SZXBvc2l0b3J5IH0gZnJvbSBcIi4uL2phdmFcIjtcbmltcG9ydCB7IEpzb25GaWxlIH0gZnJvbSBcIi4uL2pzb25cIjtcbmltcG9ydCB7IFByb2plY3QgfSBmcm9tIFwiLi4vcHJvamVjdFwiO1xuXG50eXBlIFRyYW5zZm9ybSA9IHtcbiAgbmFtZTogc3RyaW5nO1xuICBhcmdzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xufTtcbnR5cGUgU21pdGh5Q29tbW9uID0ge1xuICBpbXBvcnRzPzogc3RyaW5nW107XG4gIHBsdWdpbnM/OiBQbHVnaW5zVHlwZTtcbn07XG50eXBlIFBsdWdpblZhbHVlID0ge1xuICBzZXJ2aWNlPzogc3RyaW5nO1xuICBba2V5OiBzdHJpbmddOiBhbnk7XG59O1xuZXhwb3J0IHR5cGUgUHJvamVjdGlvblZhbHVlID0gU21pdGh5Q29tbW9uICYge1xuICBhYnN0cmFjdD86IGJvb2xlYW47XG4gIHRyYW5zZm9ybXM/OiBUcmFuc2Zvcm1bXTtcbn07XG5leHBvcnQgdHlwZSBQcm9qZWN0aW9uS2V5ID0gc3RyaW5nO1xuZXhwb3J0IHR5cGUgUHJvamVjdGlvbnNUeXBlID0gUmVjb3JkPFByb2plY3Rpb25LZXksIFByb2plY3Rpb25WYWx1ZT47XG5leHBvcnQgdHlwZSBQbHVnaW5LZXkgPSBzdHJpbmc7XG5leHBvcnQgdHlwZSBQbHVnaW5zVHlwZSA9IFJlY29yZDxQbHVnaW5LZXksIFBsdWdpblZhbHVlPjtcblxuLyoqXG4gKiBNYXZlbiByZXBvc2l0b3J5IGRlZmluaXRpb24gZm9yIGEgc21pdGh5IGJ1aWxkIGZpbGVcbiAqL1xuZXhwb3J0IHR5cGUgU21pdGh5TWF2ZW5SZXBvc2l0b3J5ID0gUGFydGlhbDxNYXZlblJlcG9zaXRvcnk+ICZcbiAgUGljazxNYXZlblJlcG9zaXRvcnksIFwidXJsXCI+O1xuXG5leHBvcnQgaW50ZXJmYWNlIFNtaXRoeU1hdmVuQ29uZmlnIHtcbiAgLyoqXG4gICAqIExpc3Qgb2Ygc21pdGh5IGRlcGVuZGVuY2llcywgZm9yIGV4YW1wbGUgW1wic29mdHdhcmUuYW1hem9uLnNtaXRoeTpzbWl0aHktY2xpOjEuMjcuMlwiXVxuICAgKi9cbiAgcmVhZG9ubHkgZGVwZW5kZW5jaWVzOiBzdHJpbmdbXTtcbiAgLyoqXG4gICAqIExpc3Qgb2YgbWF2ZW4gcmVwb3NpdG9yaWVzIGZvciBzbWl0aHkgZGVwZW5kZW5jaWVzXG4gICAqL1xuICByZWFkb25seSByZXBvc2l0b3JpZXM6IFNtaXRoeU1hdmVuUmVwb3NpdG9yeVtdO1xufVxuXG4vKipcbiAqIE9wdGlvbnMgZm9yIGBTbWl0aHlCdWlsZGBcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBTbWl0aHlCdWlsZE9wdGlvbnMgZXh0ZW5kcyBTbWl0aHlDb21tb24ge1xuICAvKipcbiAgICogRGVmaW5lcyB0aGUgdmVyc2lvbiBvZiBzbWl0aHktYnVpbGQuXG4gICAqIEBkZWZhdWx0IFwiMS4wXCJcbiAgICovXG4gIHJlYWRvbmx5IHZlcnNpb24/OiBzdHJpbmc7XG4gIC8qKlxuICAgKiBTcGVjaWZpZXMgYSBsb2NhdGlvbiB3aGVyZSBzbWl0aHkgcHJvamVjdGlvbnMgYXJlIHdyaXR0ZW4uXG4gICAqIEBkZWZhdWx0IC0gbm8gb3V0cHV0IGRpcmVjdG9yeVxuICAgKi9cbiAgcmVhZG9ubHkgb3V0cHV0RGlyZWN0b3J5Pzogc3RyaW5nO1xuICAvKipcbiAgICogTWFwIG9mIHByb2plY3Rpb25zIG5hbWUgdG8gcHJvamVjdGlvbiBjb25maWd1cmF0aW9uc1xuICAgKiBodHRwczovL2F3c2xhYnMuZ2l0aHViLmlvL3NtaXRoeS8xLjAvZ3VpZGVzL2J1aWxkaW5nLW1vZGVscy9idWlsZC1jb25maWcuaHRtbCNwcm9qZWN0aW9uc1xuICAgKiBAZGVmYXVsdCAtIG5vIHByb2plY3Rpb25zXG4gICAqL1xuICByZWFkb25seSBwcm9qZWN0aW9ucz86IFByb2plY3Rpb25zVHlwZTtcbiAgLyoqXG4gICAqIElmIGEgcGx1Z2luIGNhbid0IGJlIGZvdW5kLCBTbWl0aHkgd2lsbCBieSBkZWZhdWx0IGZhaWwgdGhlIGJ1aWxkLlxuICAgKiBUaGlzIHNldHRpbmcgY2FuIGJlIHNldCB0byB0cnVlIHRvIGFsbG93IHRoZSBidWlsZCB0byBwcm9ncmVzc1xuICAgKiBldmVuIGlmIGEgcGx1Z2luIGNhbid0IGJlIGZvdW5kIG9uIHRoZSBjbGFzc3BhdGguXG4gICAqXG4gICAqIEBkZWZhdWx0IC0gbm8gaWdub3JlTWlzc2luZ1BsdWdpbnMgc2V0IGluIHRoZSBzbWl0aHktYnVpbGQuanNvbiBmaWxlXG4gICAqL1xuICByZWFkb25seSBpZ25vcmVNaXNzaW5nUGx1Z2lucz86IGJvb2xlYW47XG4gIC8qKlxuICAgKiBNYXZlbiBjb25maWd1cmF0aW9uLCB1c2VkIHRvIGRlY2xhcmUgZGVwZW5kZW5jaWVzIGZvciB0aGUgc21pdGh5IHZzLWNvZGUgcGx1Z2luXG4gICAqIEBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2F3c2xhYnMvc21pdGh5LXZzY29kZS9ibG9iL21haW4vUkVBRE1FLm1kI2F1dGhvcmluZy1hLW1vZGVsXG4gICAqIEBkZWZhdWx0IC0gbm8gbWF2ZW4gY29uZmlndXJhdGlvbiBzZXQgaW4gdGhlIHNtaXRoeS1idWlsZC5qc29uIGZpbGVcbiAgICovXG4gIHJlYWRvbmx5IG1hdmVuPzogU21pdGh5TWF2ZW5Db25maWc7XG59XG5cbi8qKlxuICogU21pdGh5IGJ1aWxkIGNvbmZpZ3VyYXRpb24gb3B0aW9uc1xuICovXG5leHBvcnQgY2xhc3MgU21pdGh5QnVpbGQgZXh0ZW5kcyBDb21wb25lbnQge1xuICAvKipcbiAgICogRGVmaW5lcyB0aGUgdmVyc2lvbiBvZiBzbWl0aHktYnVpbGQuXG4gICAqIEBkZWZhdWx0IFwiMS4wXCJcbiAgICovXG4gIHB1YmxpYyByZWFkb25seSB2ZXJzaW9uOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFNwZWNpZmllcyBhIGxvY2F0aW9uIHdoZXJlIHNtaXRoeSBwcm9qZWN0aW9ucyBhcmUgd3JpdHRlbi5cbiAgICogQGRlZmF1bHQgLSBubyBvdXRwdXQgZGlyZWN0b3J5XG4gICAqL1xuICBwdWJsaWMgcmVhZG9ubHkgb3V0cHV0RGlyZWN0b3J5Pzogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBMaXN0IG9mIGltcG9ydHMgcmVsYXRpdmUgdG8gdGhlIGxvY2F0aW9uIG9mIHNtaXRoeS1idWlsZC5qc29uIGZpbGUuXG4gICAqIEBkZWZhdWx0IG5vIGltcG9ydHNcbiAgICovXG4gIHByaXZhdGUgX2ltcG9ydHM/OiBzdHJpbmdbXTtcblxuICAvKipcbiAgICogSWYgYSBwbHVnaW4gY2FuJ3QgYmUgZm91bmQsIFNtaXRoeSB3aWxsIGJ5IGRlZmF1bHQgZmFpbCB0aGUgYnVpbGQuXG4gICAqIFRoaXMgc2V0dGluZyBjYW4gYmUgc2V0IHRvIHRydWUgdG8gYWxsb3cgdGhlIGJ1aWxkIHRvIHByb2dyZXNzXG4gICAqIGV2ZW4gaWYgYSBwbHVnaW4gY2FuJ3QgYmUgZm91bmQgb24gdGhlIGNsYXNzcGF0aC5cbiAgICpcbiAgICogQGRlZmF1bHQgLSBubyBpZ25vcmVNaXNzaW5nUGx1Z2lucyBzZXQgaW4gdGhlIHNtaXRoeS1idWlsZC5qc29uIGZpbGVcbiAgICovXG4gIHB1YmxpYyByZWFkb25seSBpZ25vcmVNaXNzaW5nUGx1Z2lucz86IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIE1hcCBvZiBwcm9qZWN0aW9ucyBuYW1lIHRvIHByb2plY3Rpb24gY29uZmlndXJhdGlvbnNcbiAgICogaHR0cHM6Ly9hd3NsYWJzLmdpdGh1Yi5pby9zbWl0aHkvMS4wL2d1aWRlcy9idWlsZGluZy1tb2RlbHMvYnVpbGQtY29uZmlnLmh0bWwjcHJvamVjdGlvbnNcbiAgICogQGRlZmF1bHQgLSBubyBwcm9qZWN0aW9uc1xuICAgKi9cbiAgcHJpdmF0ZSBfcHJvamVjdGlvbnM/OiBQcm9qZWN0aW9uc1R5cGU7XG4gIC8qKlxuICAgKiBNYXAgb2YgcGx1Z2luIG5hbWUgdG8gcGx1Z2luIGNvbmZpZ3VyYXRpb25zXG4gICAqIGh0dHBzOi8vYXdzbGFicy5naXRodWIuaW8vc21pdGh5LzEuMC9ndWlkZXMvYnVpbGRpbmctbW9kZWxzL2J1aWxkLWNvbmZpZy5odG1sI3BsdWdpbnNcbiAgICogQGRlZmF1bHQgLSBubyBwbHVnaW5zXG4gICAqL1xuICBwcml2YXRlIF9wbHVnaW5zPzogUGx1Z2luc1R5cGU7XG4gIC8qKlxuICAgKiBNYXZlbiBjb25maWd1cmF0aW9uIGZvciB0aGUgU21pdGh5IHZzLWNvZGUgZXh0ZW5zaW9uXG4gICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9hd3NsYWJzL3NtaXRoeS12c2NvZGUvYmxvYi9tYWluL1JFQURNRS5tZCNhdXRob3JpbmctYS1tb2RlbFxuICAgKi9cbiAgcHJpdmF0ZSBfbWF2ZW4/OiBTbWl0aHlNYXZlbkNvbmZpZztcblxuICBwcml2YXRlIHJlYWRvbmx5IG1hbmlmZXN0OiBhbnk7XG5cbiAgY29uc3RydWN0b3IocHJvamVjdDogUHJvamVjdCwgb3B0aW9uczogU21pdGh5QnVpbGRPcHRpb25zID0ge30pIHtcbiAgICBzdXBlcihwcm9qZWN0KTtcblxuICAgIHRoaXMudmVyc2lvbiA9IG9wdGlvbnMudmVyc2lvbiA/PyBcIjEuMFwiO1xuICAgIHRoaXMub3V0cHV0RGlyZWN0b3J5ID0gb3B0aW9ucy5vdXRwdXREaXJlY3Rvcnk7XG4gICAgdGhpcy5faW1wb3J0cyA9IG9wdGlvbnMuaW1wb3J0cztcbiAgICB0aGlzLl9wcm9qZWN0aW9ucyA9IG9wdGlvbnMucHJvamVjdGlvbnM7XG4gICAgdGhpcy5fcGx1Z2lucyA9IG9wdGlvbnMucGx1Z2lucztcbiAgICB0aGlzLmlnbm9yZU1pc3NpbmdQbHVnaW5zID0gb3B0aW9ucy5pZ25vcmVNaXNzaW5nUGx1Z2lucztcbiAgICB0aGlzLl9tYXZlbiA9IG9wdGlvbnMubWF2ZW47XG5cbiAgICB0aGlzLm1hbmlmZXN0ID0ge1xuICAgICAgdmVyc2lvbjogdGhpcy52ZXJzaW9uLFxuICAgICAgb3V0cHV0RGlyZWN0b3J5OiB0aGlzLm91dHB1dERpcmVjdG9yeSxcbiAgICAgIGltcG9ydHM6ICgpID0+IHRoaXMuX2ltcG9ydHMsXG4gICAgICBwcm9qZWN0aW9uczogKCkgPT4gdGhpcy5fcHJvamVjdGlvbnMsXG4gICAgICBwbHVnaW5zOiAoKSA9PiB0aGlzLl9wbHVnaW5zLFxuICAgICAgaWdub3JlTWlzc2luZ1BsdWdpbnM6IHRoaXMuaWdub3JlTWlzc2luZ1BsdWdpbnMsXG4gICAgICBtYXZlbjogKCkgPT4gdGhpcy5fbWF2ZW4sXG4gICAgfTtcblxuICAgIG5ldyBKc29uRmlsZSh0aGlzLnByb2plY3QsIFwic21pdGh5LWJ1aWxkLmpzb25cIiwge1xuICAgICAgb2JqOiB0aGlzLm1hbmlmZXN0LFxuICAgICAgcmVhZG9ubHk6IHRydWUsIC8vIHdlIHdhbnQgXCJ5YXJuIGFkZFwiIHRvIHdvcmsgYW5kIHdlIGhhdmUgYW50aS10YW1wZXJcbiAgICAgIG5ld2xpbmU6IGZhbHNlLCAvLyB3aGVuIGZpbGUgaXMgZWRpdGVkIGJ5IG5wbS95YXJuIGl0IGRvZXNuJ3QgaW5jbHVkZSBhIG5ld2xpbmVcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgY29uZmlndXJlZCBwcm9qZWN0aW9uc1xuICAgKi9cbiAgcHVibGljIGdldCBwcm9qZWN0aW9ucygpIHtcbiAgICByZXR1cm4gdGhpcy5fcHJvamVjdGlvbnMgPyB7IC4uLnRoaXMuX3Byb2plY3Rpb25zIH0gOiB1bmRlZmluZWQ7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGNvbmZpZ3VyZWQgaW1wb3J0c1xuICAgKi9cbiAgcHVibGljIGdldCBpbXBvcnRzKCkge1xuICAgIHJldHVybiB0aGlzLl9pbXBvcnRzID8gWy4uLnRoaXMuX2ltcG9ydHNdIDogdW5kZWZpbmVkO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjb25maWd1cmVkIHBsdWdpbnNcbiAgICovXG4gIHB1YmxpYyBnZXQgcGx1Z2lucygpIHtcbiAgICByZXR1cm4gdGhpcy5fcGx1Z2lucyA/IHsgLi4udGhpcy5fcGx1Z2lucyB9IDogdW5kZWZpbmVkO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZCBhIHNtaXRoeSBidWlsZCBpbXBvcnRcbiAgICovXG4gIHB1YmxpYyBhZGRJbXBvcnQoaW1wOiBzdHJpbmcpIHtcbiAgICB0aGlzLl9pbXBvcnRzID8gdGhpcy5faW1wb3J0cy5wdXNoKGltcCkgOiAodGhpcy5faW1wb3J0cyA9IFtgJHtpbXB9YF0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZCBzbWl0aHkgYnVpbGQgcHJvamVjdGlvbnNcbiAgICovXG4gIHB1YmxpYyBhZGRQcm9qZWN0aW9ucyhwcm9qZWN0aW9uczogUHJvamVjdGlvbnNUeXBlKSB7XG4gICAgZm9yIChjb25zdCBbaywgdl0gb2YgT2JqZWN0LmVudHJpZXMocHJvamVjdGlvbnMpKSB7XG4gICAgICB0aGlzLl9wcm9qZWN0aW9uc1xuICAgICAgICA/ICh0aGlzLl9wcm9qZWN0aW9uc1trXSA9IHYpXG4gICAgICAgIDogKHRoaXMuX3Byb2plY3Rpb25zID0geyBba106IHYgfSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEFkZCBzbWl0aHkgYnVpbGQgcGx1Z2luc1xuICAgKi9cbiAgcHVibGljIGFkZFBsdWdpbnMocGx1Z2luczogUGx1Z2luc1R5cGUpIHtcbiAgICBmb3IgKGNvbnN0IFtrLCB2XSBvZiBPYmplY3QuZW50cmllcyhwbHVnaW5zKSkge1xuICAgICAgdGhpcy5fcGx1Z2lucyA/ICh0aGlzLl9wbHVnaW5zW2tdID0gdikgOiAodGhpcy5fcGx1Z2lucyA9IHsgW2tdOiB2IH0pO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgbWF2ZW4gZGVwZW5kZW5jaWVzIHRvIHRoZSBzbWl0aHkgYnVpbGQgZm9yIHRoZSB2cy1jb2RlIHBsdWdpblxuICAgKi9cbiAgcHVibGljIGFkZE1hdmVuRGVwZW5kZW5jaWVzKC4uLmRlcGVuZGVuY2llczogc3RyaW5nW10pIHtcbiAgICB0aGlzLl9tYXZlbiA9IHtcbiAgICAgIGRlcGVuZGVuY2llczogWy4uLih0aGlzLl9tYXZlbj8uZGVwZW5kZW5jaWVzID8/IFtdKSwgLi4uZGVwZW5kZW5jaWVzXSxcbiAgICAgIHJlcG9zaXRvcmllczogdGhpcy5fbWF2ZW4/LnJlcG9zaXRvcmllcyA/PyBbXSxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZCBtYXZlbiByZXBvc2l0b3JpZXMgdG8gdGhlIHNtaXRoeSBidWlsZCBmb3IgdGhlIHZzLWNvZGUgcGx1Z2luXG4gICAqL1xuICBwdWJsaWMgYWRkTWF2ZW5SZXBvc2l0b3JpZXMoLi4ucmVwb3NpdG9yaWVzOiBTbWl0aHlNYXZlblJlcG9zaXRvcnlbXSkge1xuICAgIHRoaXMuX21hdmVuID0ge1xuICAgICAgZGVwZW5kZW5jaWVzOiB0aGlzLl9tYXZlbj8uZGVwZW5kZW5jaWVzID8/IFtdLFxuICAgICAgcmVwb3NpdG9yaWVzOiBbLi4uKHRoaXMuX21hdmVuPy5yZXBvc2l0b3JpZXMgPz8gW10pLCAuLi5yZXBvc2l0b3JpZXNdLFxuICAgIH07XG4gIH1cbn1cbiJdfQ==